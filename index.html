<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistem Pengumpulan Tugas Online</title>
    <!-- Memuat Tailwind CSS untuk styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Memuat Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Menggunakan font Inter sebagai default */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Style untuk file input yang lebih menarik */
        .file-input-wrapper {
            position: relative;
            overflow: hidden;
            display: inline-block;
        }
        .file-input-button {
            border: 1px solid #E5E7EB;
            display: inline-block;
            padding: 8px 12px;
            cursor: pointer;
            border-radius: 0.375rem;
            background-color: white;
        }
        .file-input-wrapper input[type=file] {
            font-size: 100px;
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            cursor: pointer;
        }
        .file-name {
            margin-left: 10px;
            font-style: italic;
            color: #6B7280;
        }
        /* Style untuk tab navigasi aktif */
        .nav-tab.active {
            border-bottom-color: #FBBF24; /* yellow-400 */
            color: #92400E; /* yellow-800 */
            font-weight: 600;
        }
    </style>
</head>
<body class="bg-yellow-50 text-gray-800 flex items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-4xl mx-auto">
        <!-- Halaman Login -->
        <div id="loginPage" class="w-full max-w-md mx-auto bg-white rounded-xl shadow-lg p-8 space-y-6">
            <h2 class="text-2xl font-bold text-center text-yellow-900">Selamat Datang!</h2>
            <p class="text-center text-gray-500">Silakan masuk sebagai siswa, guru, atau admin.</p>
            <div>
                <label for="loginRole" class="block text-sm font-medium text-gray-700">Saya adalah seorang</label>
                <select id="loginRole" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-yellow-500 focus:border-yellow-500">
                    <option value="siswa">Siswa</option>
                    <option value="guru">Guru</option>
                    <option value="admin">Admin</option>
                </select>
            </div>
            <div id="guruLoginSection" class="hidden">
                <label for="namaGuru" class="block text-sm font-medium text-gray-700">Nama Guru</label>
                <input type="text" id="namaGuru" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-yellow-500 focus:border-yellow-500" placeholder="Masukkan nama lengkap Anda">
                <p id="guruLoginError" class="text-red-500 text-sm mt-1 hidden">Nama guru tidak terdaftar. Silakan coba lagi.</p>
            </div>
            <div id="adminLoginSection" class="hidden">
                <label for="adminPassword" class="block text-sm font-medium text-gray-700">Password Admin</label>
                <input type="password" id="adminPassword" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-yellow-500 focus:border-yellow-500" placeholder="Masukkan password">
                <p id="adminLoginError" class="text-red-500 text-sm mt-1 hidden">Password yang Anda masukkan salah.</p>
            </div>
            <button id="loginButton" class="w-full bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-300 shadow-md">Masuk</button>
        </div>

        <!-- Kontainer Aplikasi Utama (Awalnya Tersembunyi) -->
        <div id="appContainer" class="hidden">
            <div class="bg-white rounded-xl shadow-lg p-6 md:p-8">
                <header class="mb-4">
                    <h1 class="text-3xl font-bold text-yellow-900 text-center">Portal Pengumpulan Tugas</h1>
                    <p class="text-center text-gray-500 mt-1">Platform untuk mengelola tugas siswa dan guru.</p>
                </header>

                <div class="mb-4 flex justify-end items-center space-x-2">
                    <span class="text-sm font-medium">Anda masuk sebagai: <strong id="roleDisplay" class="capitalize"></strong></span>
                </div>
                
                <!-- Navigasi Halaman -->
                <nav class="border-b border-gray-200 mb-6">
                    <div class="flex space-x-4">
                        <button id="navPage1" class="nav-tab py-2 px-4 border-b-2 border-transparent text-gray-500 hover:text-yellow-700 transition-colors">
                            Formulir Tugas
                        </button>
                        <button id="navPage2" class="nav-tab py-2 px-4 border-b-2 border-transparent text-gray-500 hover:text-yellow-700 transition-colors">
                            Rekap & Feedback
                        </button>
                         <button id="navPage3" class="nav-tab py-2 px-4 border-b-2 border-transparent text-gray-500 hover:text-yellow-700 transition-colors hidden">
                            Manajemen Guru
                        </button>
                    </div>
                </nav>

                <main>
                    <!-- Halaman 1: Form Pengumpulan Tugas (Untuk Siswa) -->
                    <div id="page1">
                        <!-- ... Konten Halaman 1 sama seperti sebelumnya ... -->
                    </div>

                    <!-- Halaman 2: Komentar Guru & Rekapitulasi -->
                    <div id="page2" class="hidden">
                        <!-- ... Konten Halaman 2 sama seperti sebelumnya ... -->
                    </div>

                    <!-- Halaman 3: Manajemen Guru (Untuk Admin) -->
                    <div id="page3" class="hidden">
                        <h2 class="text-xl font-semibold mb-4 text-yellow-800 border-b pb-2">Manajemen Data Guru</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mt-4">
                            <div>
                                <h3 class="text-lg font-semibold text-gray-800 mb-2">Tambah Guru Baru</h3>
                                <form id="addTeacherForm" class="flex items-center space-x-2">
                                    <input type="text" id="newTeacherName" placeholder="Nama lengkap guru" class="block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-yellow-500 focus:border-yellow-500" required>
                                    <button type="submit" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded-lg transition-colors">Tambah</button>
                                </form>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold text-gray-800 mb-2">Daftar Guru Terdaftar</h3>
                                <ul id="teacherList" class="space-y-2 list-disc list-inside bg-gray-50 p-4 rounded-md border">
                                    <!-- Daftar guru akan di-render di sini -->
                                </ul>
                            </div>
                        </div>
                    </div>
                </main>
            </div>
            <footer class="text-center mt-4 text-sm text-gray-500">
                <p>Dibuat dengan ❤️ untuk Pendidikan</p>
            </footer>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- ELEMEN DOM ---
            const loginPage = document.getElementById('loginPage');
            const appContainer = document.getElementById('appContainer');
            const loginRole = document.getElementById('loginRole');
            const guruLoginSection = document.getElementById('guruLoginSection');
            const adminLoginSection = document.getElementById('adminLoginSection');
            const namaGuru = document.getElementById('namaGuru');
            const adminPassword = document.getElementById('adminPassword');
            const guruLoginError = document.getElementById('guruLoginError');
            const adminLoginError = document.getElementById('adminLoginError');
            const loginButton = document.getElementById('loginButton');
            
            const roleDisplay = document.getElementById('roleDisplay');
            const page1 = document.getElementById('page1'); // Kontennya tidak ditampilkan di sini untuk keringkasan
            const page2 = document.getElementById('page2'); // Kontennya tidak ditampilkan di sini untuk keringkasan
            const page3 = document.getElementById('page3');
            const navPage1 = document.getElementById('navPage1');
            const navPage2 = document.getElementById('navPage2');
            const navPage3 = document.getElementById('navPage3');
            const deadlineInput = document.getElementById('deadlineInput');
            const komentarGuru = document.getElementById('komentarGuru');
            const rekapTabelBody = document.getElementById('rekapTabelBody');
            
            // Elemen Manajemen Guru
            const teacherList = document.getElementById('teacherList');
            const addTeacherForm = document.getElementById('addTeacherForm');
            const newTeacherName = document.getElementById('newTeacherName');

            // --- DATA APLIKASI (STATE) ---
            const adminPasswordKey = '12345';
            let loggedInRole = '';
            let daftarGuru = ['Meli', 'Udin', 'Ratna', 'Surya'];
            let daftarSiswa = [
                { id: 1, nama: 'Budi Santoso', kelas: '10A', mapel: 'Matematika', sudahMengumpulkan: false },
                { id: 2, nama: 'Ani Yudhoyono', kelas: '10A', mapel: 'Matematika', sudahMengumpulkan: false },
                { id: 3, nama: 'Citra Lestari', kelas: '10B', mapel: 'Fisika', sudahMengumpulkan: false },
            ];

            // Re-populasi Halaman 1 dan 2 yang disembunyikan
            page1.innerHTML = `<div id="formContainer">
                            <h2 class="text-xl font-semibold mb-4 text-yellow-800 border-b pb-2">Formulir Pengumpulan Tugas</h2>
                            <form id="submissionForm" class="space-y-4">
                                <div><label for="namaSiswa" class="block text-sm font-medium text-gray-700">Nama Lengkap</label><input type="text" id="namaSiswa" name="namaSiswa" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-yellow-500 focus:border-yellow-500" required></div>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div><label for="kelas" class="block text-sm font-medium text-gray-700">Kelas</label><input type="text" id="kelas" name="kelas" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-yellow-500 focus:border-yellow-500" required></div>
                                    <div><label for="mapel" class="block text-sm font-medium text-gray-700">Mata Pelajaran</label><input type="text" id="mapel" name="mapel" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-yellow-500 focus:border-yellow-500" required></div>
                                </div>
                                <div><label class="block text-sm font-medium text-gray-700">Upload File Tugas</label><div class="mt-1 flex items-center"><div class="file-input-wrapper"><button type="button" class="file-input-button">Pilih File</button><input type="file" id="fileTugas" name="fileTugas" required></div><span id="fileName" class="file-name">Belum ada file dipilih</span></div></div>
                                <div><label for="kesimpulan" class="block text-sm font-medium text-gray-700">Kesimpulan Pelajaran</label><textarea id="kesimpulan" name="kesimpulan" rows="4" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-yellow-500 focus:border-yellow-500" placeholder="Tuliskan apa yang Anda pelajari dari tugas ini..."></textarea></div>
                                <div class="pt-2"><button type="submit" class="w-full bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-300 shadow-md">Kumpulkan Tugas</button></div>
                            </form>
                        </div><div id="deadlineMessage" class="hidden text-center p-6 bg-red-100 text-red-700 rounded-lg"><h3 class="font-bold text-lg">Waktu Habis!</h3><p>Maaf, batas waktu pengumpulan tugas telah berakhir.</p></div>`;

            page2.innerHTML = `<div class="space-y-6">
                            <div><h3 class="text-lg font-semibold text-yellow-800">Batas Waktu Pengumpulan</h3><div class="mt-2"><input type="datetime-local" id="deadlineInput" class="w-full md:w-1/2 p-2 border border-gray-300 rounded-md focus:ring-yellow-500 focus:border-yellow-500 disabled:bg-gray-100 disabled:cursor-not-allowed"><p class="text-xs text-gray-500 mt-1">Guru dapat mengubah batas waktu.</p></div></div>
                            <div><h3 class="text-lg font-semibold text-yellow-800">Komentar & Feedback Guru</h3><textarea id="komentarGuru" rows="5" class="mt-2 w-full p-3 border border-gray-300 rounded-md focus:ring-yellow-500 focus:border-yellow-500 disabled:bg-gray-100" placeholder="Guru akan memberikan feedback di sini..."></textarea><p class="text-xs text-gray-500 mt-1">Hanya guru yang dapat mengisi komentar ini.</p></div>
                            <div><h2 class="text-xl font-semibold mb-4 text-yellow-800 border-b pb-2">Rekapitulasi Pengumpulan Tugas</h2><div class="overflow-x-auto mt-4"><table class="min-w-full bg-white border border-gray-200 rounded-lg"><thead class="bg-yellow-100"><tr><th class="px-6 py-3 text-left text-xs font-medium text-yellow-800 uppercase tracking-wider">Nama Siswa</th><th class="px-6 py-3 text-left text-xs font-medium text-yellow-800 uppercase tracking-wider">Kelas</th><th class="px-6 py-3 text-left text-xs font-medium text-yellow-800 uppercase tracking-wider">Mata Pelajaran</th><th class="px-6 py-3 text-left text-xs font-medium text-yellow-800 uppercase tracking-wider">Status</th></tr></thead><tbody id="rekapTabelBody" class="divide-y divide-gray-200"></tbody></table></div></div>
                        </div>`;
            
            // Re-assign DOM elements that were inside the re-populated HTML
            const submissionForm = document.getElementById('submissionForm');
            const fileInput = document.getElementById('fileTugas');
            const fileNameSpan = document.getElementById('fileName');

            // --- FUNGSI-FUNGSI ---
            function navigateTo(pageId) {
                [page1, page2, page3].forEach(p => p.classList.add('hidden'));
                [navPage1, navPage2, navPage3].forEach(n => n.classList.remove('active'));

                const pageToShow = document.getElementById(pageId);
                const navToActivate = document.getElementById('nav' + pageId.charAt(0).toUpperCase() + pageId.slice(1));
                
                if(pageToShow) pageToShow.classList.remove('hidden');
                if(navToActivate) navToActivate.classList.add('active');
            }

            function renderTabelSiswa() {
                rekapTabelBody.innerHTML = '';
                // ... (Fungsi render tabel siswa sama seperti sebelumnya)
            }
            
            function renderTeacherList() {
                teacherList.innerHTML = '';
                if(daftarGuru.length === 0) {
                    teacherList.innerHTML = '<li class="text-gray-500 italic">Belum ada guru yang terdaftar.</li>';
                } else {
                    daftarGuru.forEach(guru => {
                        const li = document.createElement('li');
                        li.className = 'flex justify-between items-center';
                        li.textContent = guru;
                        
                        const deleteButton = document.createElement('button');
                        deleteButton.textContent = 'Hapus';
                        deleteButton.className = 'text-red-500 hover:text-red-700 text-sm font-semibold';
                        deleteButton.onclick = () => {
                            if (confirm(`Apakah Anda yakin ingin menghapus guru "${guru}"?`)) {
                                daftarGuru = daftarGuru.filter(g => g !== guru);
                                renderTeacherList();
                            }
                        };
                        li.appendChild(deleteButton);
                        teacherList.appendChild(li);
                    });
                }
            }
            
            function updateUI() {
                roleDisplay.textContent = loggedInRole;
                navPage1.classList.toggle('hidden', loggedInRole === 'admin' || loggedInRole === 'guru');
                navPage3.classList.toggle('hidden', loggedInRole !== 'admin');
                
                document.getElementById('deadlineInput').disabled = loggedInRole !== 'guru';
                document.getElementById('komentarGuru').disabled = loggedInRole !== 'guru';

                if (loggedInRole === 'siswa') navigateTo('page1');
                if (loggedInRole === 'guru') navigateTo('page2');
                if (loggedInRole === 'admin') navigateTo('page3');
            }
            
            // --- EVENT LISTENERS ---
            loginRole.addEventListener('change', function() {
                guruLoginSection.classList.add('hidden');
                adminLoginSection.classList.add('hidden');
                guruLoginError.classList.add('hidden');
                adminLoginError.classList.add('hidden');

                if (this.value === 'guru') guruLoginSection.classList.remove('hidden');
                if (this.value === 'admin') adminLoginSection.classList.remove('hidden');
            });

            loginButton.addEventListener('click', function() {
                const role = loginRole.value;
                let isValid = false;

                if (role === 'siswa') {
                    isValid = true;
                } else if (role === 'guru') {
                    const guruName = namaGuru.value.trim();
                    if (daftarGuru.some(g => g.toLowerCase() === guruName.toLowerCase())) {
                        isValid = true;
                    } else {
                        guruLoginError.classList.remove('hidden');
                    }
                } else if (role === 'admin') {
                    if (adminPassword.value === adminPasswordKey) {
                        isValid = true;
                    } else {
                        adminLoginError.classList.remove('hidden');
                    }
                }

                if (isValid) {
                    loggedInRole = role;
                    loginPage.classList.add('hidden');
                    appContainer.classList.remove('hidden');
                    initApp();
                }
            });

            addTeacherForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const newName = newTeacherName.value.trim();
                if (newName && !daftarGuru.some(g => g.toLowerCase() === newName.toLowerCase())) {
                    daftarGuru.push(newName);
                    renderTeacherList();
                    newTeacherName.value = '';
                    alert(`Guru "${newName}" berhasil ditambahkan.`);
                } else if (!newName) {
                    alert('Nama guru tidak boleh kosong.');
                }
                else {
                    alert(`Guru dengan nama "${newName}" sudah ada.`);
                }
            });

            [navPage1, navPage2, navPage3].forEach(nav => {
                nav.addEventListener('click', () => navigateTo(nav.id.replace('nav', '')));
            });

            // --- INISIALISASI APLIKASI ---
            function initApp() {
                // ... (fungsi init sama, tapi panggil renderTeacherList jika admin)
                if (loggedInRole === 'admin') {
                    renderTeacherList();
                }
                updateUI();
            }
        });
    </script>
</body>
</html>
